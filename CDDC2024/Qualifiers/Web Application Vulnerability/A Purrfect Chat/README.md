# Challenge Name: <#A Purrfect Chat>

- Category: Web Application Vulnerability
- Points: <100>
- Solves: <161>

## Challenge Description

A chat with a cat

https://cddc2024-a-purrfect-chat.s3.ap-southeast-1.amazonaws.com/index.html

Flag format : CDDC24{   }

## Solution

![Screenshot of the challenge](/Images/CDDC2024_Qualifiers/Qualifier_WebExPurrfect.png)

Inputting any strings into the chatbox gives `Try Again :(`, we can see whats causing the error by looking into the source code and search for the string "try again".

The source code of the website is very long, but there is only one part that we need:

```
function gc({result: e, value: t}) {
    const [n,r] = He.useState("Please input the answer")
      , l = Cp(i=>i.items)
      , o = ()=>/\)$/.test(t) && t.split("")[7] === l[4].toString() && t.split("")[9].charCodeAt() === parseInt(100 + l[7] % l[6]) && t.slice(11, 13) === "Brilliant".substring(7) && t.split("")[2] === l[3] + ""
      , u = ()=>t.split("")[15] === "d" && t.split("")[3].charCodeAt() === 99 && t.split("")[14].charCodeAt() === parseFloat(l[1] + l[2]) && t.split("")[10] === "0";
    return He.useEffect(()=>{
        e === "o" && t.split("")[16].charCodeAt() === 58 && o() && u() ? r("Correct!") : e === "x" && r("Try again :(")
    }
    , [e]),
    Q.jsx("span", {
        className: "bg-white rounded-3xl rounded-bl-none p-4 w-4/5 mt-4 ml-4",
        children: n
    })
}
gc.propTypes = {
    result: Yi.string,
    value: Yi.string
};
const Pp = "/assets/miauu-CRMPhZxe.jpg"
  , Np = "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20fill='%23969696'%20d='M16.1%20260.2c-22.6%2012.9-20.5%2047.3%203.6%2057.3L160%20376V479.3c0%2018.1%2014.6%2032.7%2032.7%2032.7c9.7%200%2018.9-4.3%2025.1-11.8l62-74.3%20123.9%2051.6c18.9%207.9%2040.8-4.5%2043.9-24.7l64-416c1.9-12.1-3.4-24.3-13.5-31.2s-23.3-7.5-34-1.4l-448%20256zm52.1%2025.5L409.7%2090.6%20190.1%20336l1.2%201L68.2%20285.7zM403.3%20425.4L236.7%20355.9%20450.8%20116.6%20403.3%20425.4z'/%3e%3c/svg%3e";
function zp() {
    const [e,t] = He.useState("")
      , [n,r] = He.useState("")
      , l = ()=>{
        e.length === 18 && e.split("")[8].charCodeAt() === parseInt("70") && e.split("")[1].charCodeAt() === 101 && e.split("")[13] === "3" && e.slice(4, -11) === "You are awesome!".substr(-4, 3) && e.split("")[0].charCodeAt() === parseInt(e.split("")[8].charCodeAt()) + 17 ? r("o") : r("x")
    }
    ;
    return Q.jsxs("div", {
        className: "rounded-xl bg-gray-300 w-2/3 h-[500px] flex flex-col gap-4",
        children: [Q.jsxs("div", {
            className: "flex gap-4 items-center pt-7 pl-7",
            children: [Q.jsx("div", {
                className: "rounded-full overflow-hidden w-20",
                children: Q.jsx("img", {
                    src: Pp,
                    className: "w-full h-full"
                })
            }), Q.jsxs("div", {
                children: [Q.jsx("p", {
                    className: "font-bold",
                    children: "Cat"
                }), Q.jsx("p", {
                    className: "text-gray-500",
                    children: "online"
                })]
            })]
        }), Q.jsxs("div", {
            className: "bg-gray-100 rounded-t-3xl p-4 pb-8 flex flex-col flex-auto",
            children: [Q.jsx(gc, {
                result: n,
                value: e
            }), Q.jsxs("div", {
                className: "flex px-5 py-2 gap-4 flex-none mt-auto rounded-2xl bg-white",
                children: [Q.jsx("input", {
                    type: "text",
                    className: "p-2 w-full",
                    placeholder: "flag",
                    value: e,
                    onChange: o=>t(o.target.value)
                }), Q.jsx("button", {
                    className: "w-6",
                    onClick: l,
                    children: Q.jsx("img", {
                        src: Np,
                        alt: "send",
                        className: "w-full h-full"
                    })
                })]
            })]
        })]
    })
}
function Tp() {
    return Q.jsx(Q.Fragment, {
        children: Q.jsx("div", {
            className: "flex justify-center mt-40",
            children: Q.jsx(zp, {})
        })
    })
}
Xl.createRoot(document.getElementById("root")).render(Q.jsx(is.StrictMode, {
    children: Q.jsx(Tp, {})
}));
```

Using ChatGPT to reformat the codes and extract the validation function, we can find the string required to get the correct input for the chatbox.

### Summary of Constraints (Revisited):

#### From zp:

Length: e.length === 18
9th Character ASCII Code: e.split("")[8].charCodeAt() === parseInt("70") (9th character is 'F')
2nd Character ASCII Code: e.split("")[1].charCodeAt() === 101 (2nd character is 'e')
14th Character: e.split("")[13] === "3" (14th character is '3')
Substring Check: e.slice(4, -11) === "You are awesome!".substr(-4, 3) (Characters from index 4 to 6 should be "som")
1st Character Relative to 9th Character: e.split("")[0].charCodeAt() === parseInt(e.split("")[8].charCodeAt()) + 17 (1st character is 'W')

#### From gc:

Last Character Parenthesis: /\)$/.test(t) (Flag should end with ')')
8th Character: t.split("")[7] === l[4].toString() (8th character should be '2')
10th Character ASCII Code: t.split("")[9].charCodeAt() === parseInt(100 + l[7] % l[6]) (10th character should be '100 + (176 % 18)' = 100 + 14 = 114 which is 'r')
Substring Check: t.slice(11, 13) === "Brilliant".substring(7) (Characters from index 11 to 12 should be "an")
3rd Character: t.split("")[2] === l[3] + "" (3rd character should be '1')
16th Character: t.split("")[15] === "d" (16th character is 'd')
4th Character ASCII Code: t.split("")[3].charCodeAt() === 99 (4th character is 'c')
15th Character ASCII Code: t.split("")[14].charCodeAt() === parseFloat(l[1] + l[2]) (15th character should be 'parseFloat("11" + "0")' = 110, which is 'n')
11th Character: t.split("")[10] === "0" (11th character is '0')
17th Character ASCII Code: t.split("")[16].charCodeAt() === 58 (17th character is ':')

We also need to find what the array l contains, which we can do so by searching through the source code

```
const Zi = e=>{
    (yc ? "production" : void 0) !== "production" && typeof e != "function" && console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");
    const t = typeof e == "function" ? bd(e) : e
      , n = (r,l)=>xp(t, r, l);
    return Object.assign(n, t),
    n
}
  , _p = e=>e ? Zi(e) : Zi
  , Cp = _p(()=>({
    items: ["10", "11", 0, 1, 2, 3, 18, 176]
```

Piecing the clues together, we get the string We1come2Fr0nt3nd:). Putting it into the chatbox gives the output "Correct" instead of giving the usual output "Try again:("

## Flag

CDDC24{We1come2Fr0nt3nd:)}

## Notes

NIL

---

[Back to home](https://github.com/kailermai/CTF-Writeups/tree/main/CDDC2024)
